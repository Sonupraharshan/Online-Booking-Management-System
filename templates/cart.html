<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Your Cart</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f8f9fa;
        color: #333;
      }
      nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #333;
        color: white;
        padding: 10px 20px;
      }
      nav a,
      nav span,
      nav button {
        color: white;
        text-decoration: none;
        font-weight: 500;
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1em;
      }
      nav a:hover,
      nav button:hover {
        text-decoration: underline;
        color: #e0e0e0;
      }
      h1 {
        text-align: center;
        margin-top: 30px;
        color: #222;
      }
      .cart-list {
        max-width: 800px;
        margin: 30px auto;
        padding: 0 20px;
      }
      .cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: white;
        padding: 15px;
        margin-bottom: 10px;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }
      .cart-item div {
        margin: 0 10px;
      }
      .checkout-btn {
        display: block;
        margin: 20px auto;
        padding: 10px 20px;
        background-color: #28a745;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 1em;
      }
      .checkout-btn:hover {
        background-color: #218838;
      }
    </style>
  </head>
  <body>
    <nav>
      <div>
        <a href="/auth/">üè† Home</a>
        <a href="/auth/login-page" id="loginLink">Login</a>
        <a href="/auth/register-page" id="registerLink">Register</a>
      </div>
      <div>
        <span id="userStatus"></span>
        <button
          id="logoutBtn"
          style="
            display: none;
            background: crimson;
            padding: 5px 10px;
            border-radius: 4px;
          "
        >
          Logout
        </button>
      </div>
    </nav>

    <h1>Your Cart</h1>

    <div class="cart-list" id="cartList">
      <!-- Cart items will be dynamically added here -->
    </div>

    <button class="checkout-btn" id="checkoutBtn">Proceed to Checkout</button>

    <script>
      // --- Login / Logout UI ---
      const token = localStorage.getItem("token");
      const username = localStorage.getItem("username");
      const loginLink = document.getElementById("loginLink");
      const registerLink = document.getElementById("registerLink");
      const logoutBtn = document.getElementById("logoutBtn");
      const userStatus = document.getElementById("userStatus");

      if (token && username) {
        userStatus.innerText = `Welcome, ${username}!`;
        loginLink.style.display = "none";
        registerLink.style.display = "none";
        logoutBtn.style.display = "inline";
      }

      logoutBtn.addEventListener("click", () => {
        localStorage.removeItem("token");
        localStorage.removeItem("username");
        window.location.href = "/auth/";
      });

      // --- Fetch and display cart items ---
      async function loadCart() {
        if (!token) {
          alert("Please login first!");
          window.location.href = "/auth/login-page";
          return;
        }

        const res = await fetch("/cart/", {
          method: "GET",
          headers: {
            Authorization: `Bearer ${token}`,
          },
        });

        const data = await res.json();
        const cartList = document.getElementById("cartList");
        cartList.innerHTML = "";

        if (data.length === 0) {
          cartList.innerHTML = "<p>Your cart is empty.</p>";
          return;
        }

        data.forEach((item) => {
          const div = document.createElement("div");
          div.classList.add("cart-item");
          div.innerHTML = `
        <div>${item.title} by ${item.author}</div>
        <div>Qty: ${item.quantity}</div>
        <div>Price: $${item.price.toFixed(2)}</div>
      `;
          cartList.appendChild(div);
        });
      }

      loadCart();

      // --- Checkout (dummy action) ---
      document.getElementById("checkoutBtn").addEventListener("click", () => {
        alert("Checkout functionality not implemented yet.");
      });
    </script>
  </body>
</html>
